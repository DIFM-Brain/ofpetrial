<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ofpetrial">
<title>Change Trial Rates Manually • ofpetrial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Change Trial Rates Manually">
<meta property="og:description" content="ofpetrial">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-B09QYRX8XQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B09QYRX8XQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ofpetrial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/V0-basic-work-flow.html">Basic Workflow</a>
    <a class="dropdown-item" href="../articles/V5-understanding-structure.html">Understanding the structure of objects generated by the package</a>
    <a class="dropdown-item" href="../articles/V1-trial-design-options.html">Trial Design Options</a>
    <a class="dropdown-item" href="../articles/V2-ab-line.html">Trial AB-line Types and Options</a>
    <a class="dropdown-item" href="../articles/V4-diagnose-td.html">Diagnose Trial Designs</a>
    <a class="dropdown-item" href="../articles/V3-change-rates-manually.html">Change Trial Rates Manually</a>
    <a class="dropdown-item" href="../articles/V6-non-regular-field.html">Non-regular fields</a>
    <a class="dropdown-item" href="../articles/V7-visualize-from-scratch.html">Modify trial design maps or make them from scratch</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DIFM-Brain/ofpetrial/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Change Trial Rates Manually</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DIFM-Brain/ofpetrial/blob/HEAD/vignettes/articles/V3-change-rates-manually.Rmd" class="external-link"><code>vignettes/articles/V3-change-rates-manually.Rmd</code></a></small>
      <div class="d-none name"><code>V3-change-rates-manually.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://difm-brain.github.io/ofpetrial/">ofpetrial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>Suppose you have created a trial design applying
<code><a href="../reference/assign_rates.html">assign_rates()</a></code> to experiment plots made by
<code><a href="../reference/make_exp_plots.html">make_exp_plots()</a></code>, but you are not quite satisfied with it
and would like to change rates here and there. You can easily do so
manually using the <code><a href="../reference/change_rates.html">change_rates()</a></code> function. This vignette
demonstrates such operations.</p>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>Let’s first create a trial design for a single input case.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot.html">prep_plot</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    unit_system <span class="op">=</span> <span class="st">"imperial"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    headland_length <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    side_length <span class="op">=</span> <span class="fl">60</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"boundary-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ab-line-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</span></span>
<span><span class="co">#&gt; Warning: There was 1 warning in `dplyr::mutate()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In argument: `experiment_plots_dissolved = list(...)`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In row 1.</span></span>
<span><span class="co">#&gt; Caused by warning:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> package 'sf' was built under R version 4.2.3</span></span>
<span></span>
<span><span class="va">n_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>    rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"ls"</span>,</span>
<span>    rank_seq_ws <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    rank_seq_as <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span></span>
<span>    exp_data <span class="op">=</span> <span class="va">exp_data</span>,</span>
<span>    rate_info <span class="op">=</span> <span class="va">n_rate_info</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Here is what the trial design looks like.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="changing-rates">Changing rates<a class="anchor" aria-label="anchor" href="#changing-rates"></a>
</h2>
<p>It is important to be aware that every single plot is assigned a
withint-strip plot id and a strip id when they were created using
<code><a href="../reference/make_exp_plots.html">make_exp_plots()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td</span><span class="op">$</span><span class="va">trial_design</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 191 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -16.70078 ymin: 39.11957 xmax: -16.69604 ymax: 39.12696</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    rate strip_id plot_id       type                       geometry</span></span>
<span><span class="co">#&gt; 1   100        1       1 experiment POLYGON ((-16.6964 39.11976...</span></span>
<span><span class="co">#&gt; 2   140        1       2 experiment POLYGON ((-16.6964 39.12047...</span></span>
<span><span class="co">#&gt; 3   180        1       3 experiment POLYGON ((-16.6964 39.12118...</span></span>
<span><span class="co">#&gt; 4   220        1       4 experiment POLYGON ((-16.6964 39.12189...</span></span>
<span><span class="co">#&gt; 5   260        1       5 experiment POLYGON ((-16.6964 39.1226,...</span></span>
<span><span class="co">#&gt; 6   100        1       6 experiment POLYGON ((-16.6964 39.12331...</span></span>
<span><span class="co">#&gt; 7   140        1       7 experiment POLYGON ((-16.6964 39.12402...</span></span>
<span><span class="co">#&gt; 8   180        1       8 experiment POLYGON ((-16.69641 39.1247...</span></span>
<span><span class="co">#&gt; 9   220        1       9 experiment POLYGON ((-16.69641 39.1254...</span></span>
<span><span class="co">#&gt; 10  260        1      10 experiment POLYGON ((-16.69641 39.1261...</span></span></code></pre></div>
<p>The figure below shows the strip id associated with each plot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"strip_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_text()`).</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The figure below shows the plot id associated with each plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"plot_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_text()`).</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>As you can see, <code>plot_id</code> is the unique numeric identifier
assigned to each of the plots <strong>within</strong> a strip. So, there
are multiple plots with the same <code>plot_id</code> values, but a
combination of <code>strip_id</code> and <code>plot_id</code> uniquely
identifies a plot.</p>
<div class="section level3">
<h3 id="re-assign-a-single-rate-to-all-the-specified-plots">Re-assign a single rate to all the specified plots<a class="anchor" aria-label="anchor" href="#re-assign-a-single-rate-to-all-the-specified-plots"></a>
</h3>
<p>You can use <code><a href="../reference/change_rates.html">change_rates()</a></code> to change rates. The code
below change the rate asscociated the plot with
<code>strip_id = 1</code> and <code>plot_id = 1</code> (left bottom
cell) to 0.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modified_td</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    td <span class="op">=</span> <span class="va">td</span>,</span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    strip_ids <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    plot_ids <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">modified_td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>You can change rates of multiple plots with the same
<code>plot_id</code> across multiple <code>strip_id</code>s.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  plot_ids <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>When you give vectors of values to <code>stip_ids</code> and
<code>plot_ids</code>, the plots with all the possible combinations of
<code>strip_id</code>-<code>plot_id</code> are going to have a new
rate.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  plot_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>If you do not provide any <code>plot_ids</code>, then all the plots
in the strips specified by <code>strip_ids</code> will be altered.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="re-assign-multiple-rates-by-strip">Re-assign multiple rates by strip<a class="anchor" aria-label="anchor" href="#re-assign-multiple-rates-by-strip"></a>
</h3>
<p>You can also change the rate of multiple plots across multiple strips
by strip using the <code>rate_by = "strip"</code> option. In this case,
<strong>n</strong>th element of <code>new_rates</code> will be assigned
to <strong>n</strong>th strip in <code>strip_ids</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>  plot_ids <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">8</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>If you leave <code>plot_ids</code> unspecified, all the plots in the
strips specified by <code>strip_ids</code> will be assigned new rates.
That is, rates are re-assigned by strip.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">150</span>, <span class="fl">200</span>, <span class="fl">100</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The <code>rate_by = "strip"</code> can be useful when you want to
“remove” some plots from the experiment. For example, take a look at
this trial design.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">td_curved</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td_curved</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Notice that there is a three-plot strip at the east end of the field.
Suppose, you would like to “remove” it from experiments (there is
nothing wrong with keeping them as part of the experiment). You can do
so by assining the rate for the non-experimental part of field (which is
180) to the strip.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td_curved</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">31</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="fl">180</span>,</span>
<span>  rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="re-assign-multiple-rates-by-plot">Re-assign multiple rates by plot<a class="anchor" aria-label="anchor" href="#re-assign-multiple-rates-by-plot"></a>
</h3>
<p>You can assign new rates plot by plot at one time using the
<code>rate_by = "plot"</code> option. For this option, you are asked to
provide a matrix of rates where rows and columns of the matrix
represents <code>plot_id</code>s and <code>strip_id</code>s,
respectively. For example, suppose you have
<code>plot_ids = c(2, 4, 6)</code> and
<code>strip_ids = c(1, 3, 5, 7)</code>. Further suppose, you have
specified <code>new_rates</code> like below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span></span>
<span>  <span class="va">new_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span> <span class="op">*</span> <span class="fl">20</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]   20   80  140  200</span></span>
<span><span class="co">#&gt; [2,]   40  100  160  220</span></span>
<span><span class="co">#&gt; [3,]   60  120  180  240</span></span></code></pre></div>
<p>Then, the plot with <code>plot_id</code> = 2 (1st element of
<code>plot_ids</code>) and <code>strip_id</code> = 1 (1st element of
<code>strip_ids</code>) will get the value stored in
<code>new_rates[1, 1]</code> (1st row and 1st column of the matrix of
rates).</p>
<p>The code below assign randomized rates to the 5-plot by 5-plot block
at the left lower corner of the field.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_rates_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>  <span class="va">td</span>,</span>
<span>  input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>  strip_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  plot_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  new_rates <span class="op">=</span> <span class="va">new_rates_mat</span>,</span>
<span>  rate_by <span class="op">=</span> <span class="st">"plot"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span>abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>If you would like, you could repeat this to other blocks of plots to
generate a randomized block design. Of course, it is much easier to just
use the “rb” option in <code><a href="../reference/assign_rates.html">assign_rates()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="application-precision-nitrogen-project-pnp-at-university-of-nebraska-lincoln">Application: Precision Nitrogen Project (PNP) at University of
Nebraska Lincoln<a class="anchor" aria-label="anchor" href="#application-precision-nitrogen-project-pnp-at-university-of-nebraska-lincoln"></a>
</h2>
<p>Here, we apply what we have learned so far to create a trial design
like the ones used in <span class="citation">Puntel, Thompson, and Mieno
(2024)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot.html">prep_plot</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    unit_system <span class="op">=</span> <span class="st">"imperial"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    headland_length <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    min_plot_length <span class="op">=</span> <span class="fl">200</span>,</span>
<span>    max_plot_length <span class="op">=</span> <span class="fl">300</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"boundary-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ab-line-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">exp_data</span>, type <span class="op">=</span> <span class="st">"layout"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">240</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>    rates <span class="op">=</span> <span class="fl">240</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"str"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span></span>
<span>    exp_data <span class="op">=</span> <span class="va">exp_data</span>,</span>
<span>    rate_info <span class="op">=</span> <span class="va">n_rate_info</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    <span class="va">td</span>,</span>
<span>    strip_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fl">180</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">td</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    strip_ids <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>    plot_ids <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">9</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span>,</span>
<span>    rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    strip_ids <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>    plot_ids <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">19</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">140</span>, <span class="fl">260</span>, <span class="fl">100</span>, <span class="fl">180</span>, <span class="fl">220</span><span class="op">)</span>,</span>
<span>    rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    strip_ids <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>    plot_ids <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">29</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">100</span>, <span class="fl">260</span>, <span class="fl">220</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>    rate_by <span class="op">=</span> <span class="st">"strip"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">td</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/change_rates.html">change_rates</a></span><span class="op">(</span></span>
<span>    <span class="va">td</span>,</span>
<span>    strip_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>    new_rates <span class="op">=</span> <span class="fl">180</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td</span>, type <span class="op">=</span> <span class="st">"rates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="V3-change-rates-manually_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-puntel2024leveraging" class="csl-entry">
Puntel, Laila A, Laura J Thompson, and Taro Mieno. 2024.
<span>“Leveraging Digital Agriculture for on-Farm Testing of
Technologies.”</span> <em>Frontiers in Agronomy</em> 6: 1234232.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Taro Mieno, Brittani Edge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
