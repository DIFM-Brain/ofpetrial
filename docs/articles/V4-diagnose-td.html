<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diagnose Trial Designs • ofpetrial</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Diagnose Trial Designs">
<meta property="og:description" content="ofpetrial">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-B09QYRX8XQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B09QYRX8XQ');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ofpetrial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/V1-trial-design-options.html">Trial Design Options</a>
    </li>
    <li>
      <a href="../articles/V2-ab-line.html">Trial AB-line Types and Options</a>
    </li>
    <li>
      <a href="../articles/V3-change-rates-manually.html">Change Trial Rates Manually</a>
    </li>
    <li>
      <a href="../articles/V4-diagnose-td.html">Diagnose Trial Designs</a>
    </li>
    <li>
      <a href="../articles/V5-understanding-structure.html">Understanding the structure of objects</a>
    </li>
    <li>
      <a href="../articles/V6-non-regular-field.html">Non-regular fields</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Diagnose Trial Designs</h1>
            
      
      
      <div class="hidden name"><code>V4-diagnose-td.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- pacakges ---#</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ofpetrial</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.6.17</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- file names ---#</span></span>
<span><span class="va">boundary_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"boundary-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span></span>
<span><span class="va">abline_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ab-line-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="check-the-alignment-of-the-harvester-and-applicatorplanter">Check the alignment of the harvester and applicator/planter<a class="anchor" aria-label="anchor" href="#check-the-alignment-of-the-harvester-and-applicatorplanter"></a>
</h2>
<p>It is ideal for each of the yield data points to be associated with a
single input rate. However, this cannot be achieved sometimes because
the width of a machine is not a multiple of that of the other machines.
In such a case, you will have a mixed treatment problem where some data
points are associated with more than one input rates. The
<code><a href="../reference/check_alignment.html">check_alignment()</a></code> function checks the alignment of
harvester and applicator/planter to quantify and visualize the degree of
mixed treatment problems of a trial design.</p>
<p>Let’s first create experiment plots where plot width is specified as
90 feet, which is twice as wide as the applicator of the nitrogen
fertilizer and three times as wide as the harvesters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">90</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="va">boundary_file</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="va">abline_file</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>Running <code><a href="../reference/check_alignment.html">check_alignment()</a></code> to <code>exp_data</code>,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span></span>
<span>  <span class="va">machine_alignment_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_alignment.html">check_alignment</a></span><span class="op">(</span><span class="va">exp_data</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   input_name                     harvest_ab_line overl…¹ harve…² g_pat…³ g_ove…⁴</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NH3        (353001.2 4331404, 353012.7 433204… &lt;dt&gt;    &lt;sf&gt;    <span style="color: #949494;">&lt;gg&gt;</span>    <span style="color: #949494;">&lt;gg&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable names ¹​overlap_data, ²​harvester_path,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​g_path_alignment, ⁴​g_overlap</span></span></span></code></pre></div>
<p>One of the elements of the resulting output is
<code>g_path_alignment</code>, which is a <code>ggplot</code> figure of
the path of the harvester (red) and applicator (blue).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">machine_alignment_check</span><span class="op">$</span><span class="va">g_path_alignment</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As you can see, three yield paths fit perfectly in a single
applicator path. That is, there is not mixed treatment problme in this
layout of experiment plots. The <code>g_overlap</code> element is a
<code>ggplot</code> figure of the histogram of the highest percentage of
the harvester strip area occupied by a single rate. In this trial
design, since all the strips have only a single input rate, all 45
strips have value of 100%.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">machine_alignment_check</span><span class="op">$</span><span class="va">g_overlap</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_bar()`).</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Now, let’s make the plot width 45 feet.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">45</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; For NH3, the plot width you specified would cause mixed treatment problems. However, there is a plot width that avoids them. It is suggested that you use 90 as the plot width.</span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="va">boundary_file</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="va">abline_file</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#--- check alignment ---#</span></span>
<span><span class="va">machine_alignment_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_alignment.html">check_alignment</a></span><span class="op">(</span><span class="va">exp_data</span><span class="op">)</span></span></code></pre></div>
<p>As you can see below, every three harvester paths is associated with
two input rates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">machine_alignment_check</span><span class="op">$</span><span class="va">g_path_alignment</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>This can be confirmed with the following figure, which shows that a
third of harvester strips have 50% mix.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">machine_alignment_check</span><span class="op">$</span><span class="va">g_overlap</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_bar()`).</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>If you see this kind of problem, reconsider changing the plot width,
unless it is not avoidable. If you are not sure what the right plot
width is, it might be advisable to leave <code>plot_width</code>
unspecified (<code>plot_width = NA</code>) in a
<code>prep_plot_*()</code> function, in which case, the package will
automally suggest an appropriate (may not be optimal) plot width.</p>
</div>
<div class="section level2">
<h2 id="check-the-correlation-of-the-input-rates-for-a-two-input-experiment">Check the correlation of the input rates for a two-input
experiment<a class="anchor" aria-label="anchor" href="#check-the-correlation-of-the-input-rates-for-a-two-input-experiment"></a>
</h2>
<p>Suppose you are running a two-input experiment. High correlation
between the two input rates should be avoided as it will hurt
statistical efficiency, rendering the estimation of the individual
impact of the two inputs inaccurate. The available pre-made trial design
options the <code>ofpetrial</code> packge are designed to avoid this
problem. However, when you assign rates yourself using the
<code>rank_seq_ws</code> and <code>rank_seq_as</code> options for the
<code>ls</code> design type, you may accidentally create trial design
where the two input rates are highly correlated. Here is an example.</p>
<p>We first create experiment plots. Note that the
<code>plot_width</code> of both inputs are the same.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"seed"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_plot_info</span>, <span class="va">n_plot_info</span><span class="op">)</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="va">boundary_file</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="va">abline_file</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now, we assign rates for both inputs using the same
<code>rank_seq_ws</code> and <code>rank_seq_as</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">seed_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">32000</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"seed"</span>,</span>
<span>    min_rate <span class="op">=</span> <span class="fl">16000</span>,</span>
<span>    max_rate <span class="op">=</span> <span class="fl">40000</span>,</span>
<span>    num_rates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"ls"</span>,</span>
<span>    rank_seq_ws <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    rank_seq_as <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Trial rates were not directly specified via the {rates} option, so the trial rates will be calculated using min_rate, max_rate, gc_rate, and num_rates</span></span>
<span></span>
<span><span class="va">n_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>    rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"ls"</span>,</span>
<span>    rank_seq_ws <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    rank_seq_as <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">td_two_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span><span class="va">exp_data</span>, rate_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_rate_info</span>, <span class="va">n_rate_info</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Trial rates were not directly specified, so the trial rates were calculated using min_rate, max_rate, gc_rate, and num_rates</span></span></code></pre></div>
<p>Here is the visualization of the assigned rates for both inputs. It
is easy to see that both input have exactly the same pattern because of
the same <code>rank_seq_ws</code> and <code>plot_width</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td_two_input</span>, abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>You can check the correlation of the two inputs using
<code><a href="../reference/check_ortho_inputs.html">check_ortho_inputs()</a></code> like this.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_ortho_inputs.html">check_ortho_inputs</a></span><span class="op">(</span><span class="va">td_two_input</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking the correlation between the two inputs. This may take some time depending on the number of experiment plots.</span></span>
<span><span class="co">#&gt; [1] 0.9958792</span></span></code></pre></div>
<p>As you can see, they are extremely highly correlated. When you see
this, you should reassign rates for one of the inputs.</p>
<p>Now, let’s change the width of the plots for NH3 to 60 feet, which is
twice as wide as that for seed. We then use the same rate information to
assign rates to the new experiment plots.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="co">#+ change the plot width for NH3</span></span>
<span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">60</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="co">#+ Recreate experient plots for NH3</span></span>
<span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_plot_info</span>, <span class="va">n_plot_info</span><span class="op">)</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="va">boundary_file</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="va">abline_file</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="co">#+ Assign rates again with the same rate information</span></span>
<span><span class="co">#++++++++++++++++++++++++++++++++++++</span></span>
<span><span class="va">td_two_input_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span><span class="va">exp_data</span>, rate_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_rate_info</span>, <span class="va">n_rate_info</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Trial rates were not directly specified, so the trial rates were calculated using min_rate, max_rate, gc_rate, and num_rates</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td_two_input_2</span>, abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Now, there are two plots of different rates of seed in a single plot
of NH3. Consequently, their correlation is very low now.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_ortho_inputs.html">check_ortho_inputs</a></span><span class="op">(</span><span class="va">td_two_input_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking the correlation between the two inputs. This may take some time depending on the number of experiment plots.</span></span>
<span><span class="co">#&gt; [1] 0.06639064</span></span></code></pre></div>
<hr>
<p>Now, let’s think about a case where the randomized block design is
used for both inputs<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> We are using the same plot width for both
inputs just like the first case.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_plot_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_plot_f.html">prep_plot_f</a></span><span class="op">(</span></span>
<span>    input_name <span class="op">=</span> <span class="st">"NH3"</span>,</span>
<span>    machine_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    section_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    harvester_width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    plot_width <span class="op">=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="va">exp_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/make_exp_plots.html">make_exp_plots</a></span><span class="op">(</span></span>
<span>    input_plot_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_plot_info</span>, <span class="va">n_plot_info</span><span class="op">)</span>,</span>
<span>    boundary_data <span class="op">=</span> <span class="va">boundary_file</span>,</span>
<span>    abline_data <span class="op">=</span> <span class="va">abline_file</span>,</span>
<span>    abline_type <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now, we assign rates for both inputs using the randomized block
design (<code>rb</code>). Since rates are randomly assigned by block for
both inputs, some cases introduce a higher correlation than others.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">seed_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">32000</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"seed"</span>,</span>
<span>    min_rate <span class="op">=</span> <span class="fl">16000</span>,</span>
<span>    max_rate <span class="op">=</span> <span class="fl">40000</span>,</span>
<span>    num_rates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"rb"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Trial rates were not directly specified via the {rates} option, so the trial rates will be calculated using min_rate, max_rate, gc_rate, and num_rates</span></span>
<span></span>
<span><span class="va">n_rate_info</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/prep_rate.html">prep_rate</a></span><span class="op">(</span></span>
<span>    plot_info <span class="op">=</span> <span class="va">n_plot_info</span>,</span>
<span>    gc_rate <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    unit <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>    rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span>, <span class="fl">180</span>, <span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span>,</span>
<span>    design_type <span class="op">=</span> <span class="st">"rb"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The first case has a correlation of -0.1049839, while the second case
is 0.0240804.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- case 1 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">543</span><span class="op">)</span></span>
<span><span class="va">td_two_input_rb_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span><span class="va">exp_data</span>, rate_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_rate_info</span>, <span class="va">n_rate_info</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_case_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_ortho_inputs.html">check_ortho_inputs</a></span><span class="op">(</span><span class="va">td_two_input_rb_1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_case_1</span></span>
<span><span class="co">#&gt; [1] -0.1049839</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- case 2 ---#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">383543</span><span class="op">)</span></span>
<span><span class="va">td_two_input_rb_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_rates.html">assign_rates</a></span><span class="op">(</span><span class="va">exp_data</span>, rate_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">seed_rate_info</span>, <span class="va">n_rate_info</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_case_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_ortho_inputs.html">check_ortho_inputs</a></span><span class="op">(</span><span class="va">td_two_input_rb_2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_case_2</span></span>
<span><span class="co">#&gt; [1] 0.0240804</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-the-correlation-of-the-input-rates-with-observed-fieldtopographic-characteristics">Check the correlation of the input rates with observed
field/topographic characteristics<a class="anchor" aria-label="anchor" href="#check-the-correlation-of-the-input-rates-with-observed-fieldtopographic-characteristics"></a>
</h2>
<p>When analyzing the experiment data and applying statistical methods
to estimate yield response functions, field and topographic
characteristics are often included in the model to control for their
effects, which help isolate the impact of the input on yield. In
designing experiments, it would be nice to have the input rates
uncorrelated (orthogonal to) with those observed characteristics. The
<code><a href="../reference/check_ortho_with_chars.html">check_ortho_with_chars()</a></code> checks this.</p>
<p>Let’s first import an already-design trial design called
<code>td_single_input</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">td_single_input</span><span class="op">)</span></span></code></pre></div>
<p>Here is the visualization of the trial desing.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viz.html">viz</a></span><span class="op">(</span><span class="va">td_single_input</span>, abline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Here, we have three sets of spatial data we want to check.</p>
<ul>
<li>Past yield data (<code>Yld_Vol_Dr</code>) from the same field
(points data)</li>
<li>SSURGO data (polygons data)
<ul>
<li>clay content (<code>clay</code>)</li>
<li>soil category (<code>mukey</code>)</li>
</ul>
</li>
<li>Slope (<code>slope</code>) of the field (raster data)</li>
<li>Topographic Wetness Index (<code>twi</code>) of the field (raster
data)</li>
</ul>
<hr>
<p><strong>Yield data</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yield_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"yield-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `yield-simple1' from data source </span></span>
<span><span class="co">#&gt;   `/private/var/folders/t4/5gnqprbn38nftyxkyk5hdwmd8hnypy/T/RtmpO9VLgR/temp_libpathdea715c37044/ofpetrial/extdata/yield-simple1.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 16822 features and 34 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -16.70075 ymin: 39.11962 xmax: -16.69612 ymax: 39.1269</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">yield_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Yld_Vol_Dr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<hr>
<p><strong>SSURGO</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssurgo_sf</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ssurgo-simple1.shp"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mukey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mukey</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `ssurgo-simple1' from data source </span></span>
<span><span class="co">#&gt;   `/private/var/folders/t4/5gnqprbn38nftyxkyk5hdwmd8hnypy/T/RtmpO9VLgR/temp_libpathdea715c37044/ofpetrial/extdata/ssurgo-simple1.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 11 features and 9 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -16.70096 ymin: 39.11957 xmax: -16.69587 ymax: 39.12696</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ssurgo_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mukey</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ssurgo_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">clay</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-26-2.png" width="700"></p>
<hr>
<p><strong>Slope and TWI</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topo_rast</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"slope.tif"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"twi.tif"</span>, package <span class="op">=</span> <span class="st">"ofpetrial"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">topo_rast</span><span class="op">)</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<hr>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checks</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/check_ortho_with_chars.html">check_ortho_with_chars</a></span><span class="op">(</span></span>
<span>    td <span class="op">=</span> <span class="va">td_single_input</span>,</span>
<span>    sp_data_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yield_sf</span>, <span class="va">ssurgo_sf</span>, <span class="va">topo_rast</span><span class="op">)</span>,</span>
<span>    vars_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Yld_Vol_Dr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mukey"</span>, <span class="st">"clay"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">topo_rast</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Computation failed in `stat_bin()`</span></span>
<span><span class="co">#&gt; Caused by error in `abs()`:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> non-numeric argument to mathematical function</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checks</span><span class="op">$</span><span class="va">summary_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;          var cor_with_rate</span></span>
<span><span class="co">#&gt; 1 Yld_Vol_Dr    0.01821775</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">checks</span><span class="op">$</span><span class="va">summary_fig</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="V4-diagnose-td_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>we do not recommend using the randomized block design.
see add citation.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Taro Mieno, Brittani Edge.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
